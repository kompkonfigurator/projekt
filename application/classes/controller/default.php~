<?php defined('SYSPATH') or die('No direct script access.');

class Controller_Default extends Controller_Template {

    public $template = 'default';

    public function  __construct(Request $request, Response $response) {
        parent::__construct($request, $response);

        if(isset($_COOKIE['lang'])){
            setcookie("lang", $_COOKIE['lang'],31536000 + time(),'/');
            I18n::lang($_COOKIE['lang']);
        }
    }

    public function before() {
      parent::before();

        if ($this->auto_render)
        {
            // Initialize empty values
            $this->template->title = '';
            $this->template->description = '';
            $this->template->content = '';

            $this->template->styles = array();
            $this->template->scripts = array();
            $this->template->top_tab = '';
        }
    }

    public function after() {
        if ($this->auto_render)
        {
                $styles = array(
                        'media/css/style.css' => 'screen',
                );

                $scripts = array(
                        'media/js/jquery-1.6.2.min.js',
                );

                $this->template->styles = array_merge( $this->template->styles, $styles );
                $this->template->scripts = array_merge( $this->template->scripts, $scripts );
                $this->template->langs=Kohana::$config->load('lang');
        }
        parent::after();
    }

    public function action_index() {
        $this->template->content=View::factory('home');
        $this->template->title = __('Home');
        $this->template->top_tab='home';
    }
}
?>
